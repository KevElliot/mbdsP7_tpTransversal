<div class="row mb-1">
    <div class="col">
        <div class="input-group mb-3 box-shadow">
            <div class="input-group-prepend">
                <span *ngIf="!loadList" class="input-group-text border-top-0 border-left-0 border-bottom-0"><i
                        class="fa fa-search"></i></span>
                <span *ngIf="loadList" class="spinner-border pull-right loader">Loading...</span>
            </div>
            <input type="text" [(ngModel)]="searchText" placeholder="Recherche matchs par lieu..."
                   class="form-control border-0">
            <div class="input-group-append">
                <span (click)="openModal(modalContent, null)"
                      class="input-group-text border-top-0 border-right-0 border-bottom-0"><i
                        class="fa fa-user-plus"></i></span>
                <span (click)="toggle('grid')" class="input-group-text border-top-0 border-right-0 border-bottom-0"><i
                        class="fa fa-th"></i></span>
                <span (click)="toggle('list')" class="input-group-text border-top-0 border-right-0 border-bottom-0"><i
                        class="fa fa-list"></i></span>
            </div>
        </div>
    </div>
</div>

<div *ngIf="type=='grid'" class="row">
    <div *ngFor="let match of matchs | MatchSearchPipe : searchText | paginate: { itemsPerPage: 6, currentPage: p }; let i = index;"
         class="col-xl-4 col-lg-6 mb-4">
        <div class="flip">
            <div class="content">
                <div class="front">
                    <div class="card border-0 box-shadow rounded-0">
                        <div class="card-header border-0 rounded-0 text-muted">
                            <h5 class="mb-0">
                                {{match.datematch | date:"dd-MM-yyyy HH:mm" }} à {{match.lieumatch}}
                            </h5>
                            <div class="widget-controls">
                                <a *ngIf="editResult" (click)="openMenuAssign($event,match)" href="javascript:void(0);"
                                   class="transition"><i
                                        class="fa fa-pencil text-success"></i></a>
                                <a (click)="openModal(modalContent, match)" href="javascript:void(0);"
                                   class="transition"><i class="fa fa-pencil"></i></a>
                            </div>
                        </div>
                        <div class="card-body pt-3">

                            <div class="media">
                                <div class="d-flex flex-column justify-content-center">

                                </div>
                                <div class="media-body ml-3">
                                    <div class="row">
                                        <div class="col-4 text-gray text-right pr-0 font-italic text-truncate">Equipe
                                            1:
                                        </div>
                                        <div class="col-8 pl-2 text-truncate">{{match.equipe1?.nom}}</div>
                                        <div class="col-4 text-gray text-right pr-0 font-italic text-truncate">Equipe
                                            2:
                                        </div>
                                        <div class="col-8 pl-2 text-truncate">{{match.equipe2?.nom}}</div>
                                        <div class="col-4 text-gray text-right pr-0 font-italic text-truncate">cote V1
                                            :
                                        </div>
                                        <div class="col-8 pl-2 text-truncate">{{match.cotev1}}</div>
                                        <div class="col-4 text-gray text-right pr-0 font-italic text-truncate">Cote X:
                                        </div>
                                        <div class="col-8 pl-2 text-truncate">{{match.cotex}}</div>
                                        <div class="col-4 text-gray text-right pr-0 font-italic text-truncate">Cote
                                            V2:
                                        </div>
                                        <div class="col-8 pl-2 text-truncate">{{match.cotev2}}</div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="back">
                    <div class="card border-0 box-shadow rounded-0">
                        <div class="card-header border-0 rounded-0 text-muted">
                            <h5 class="mb-0">
                                {{match.datematch | date:"dd-MM-yyyy HH:mm" }} à {{match.lieumatch}}
                            </h5>
                            <div class="widget-controls">
                                <a *ngIf="!load" (click)="closeMenuAssign($event)" href="javascript:void(0);"
                                   class="transition"><i class="fa fa-times"></i></a>
                                <span *ngIf="load" class="spinner-border pull-right loader">Loading...</span>
                            </div>
                        </div>
                        <div class="card-body pt-3">
                            <form [formGroup]="formResultat" (ngSubmit)="onSubmitResultat(formResultat.value)"
                                  class="row px-3">
                                <div class="row">
                                    <div class="form-group col-sm-6">
                                        <label class="text-gray">{{match.equipe1.nom}}</label>
                                        <input formControlName="but1" class="form-control form-control-sm"
                                               type="number">
                                    </div>
                                    <div class="form-group col-sm-6">
                                        <label class="text-gray">{{match.equipe2.nom}}</label>
                                        <input formControlName="but2" class="form-control form-control-sm"
                                               type="number">
                                    </div>
                                </div>
                                <div class="w-100 text-center pt-3">
                                    <button [disabled]="!formResultat.valid" class="btn btn-success">Enregistrer
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div *ngIf="type=='list'" class="row">
    <div class="col-12">
        <div class="table-responsive bg-white box-shadow">
            <table class="table table-hover">
                <thead>
                <tr>
                    <th>Date</th>
                    <th>Equipe 1</th>
                    <th>Cote V1</th>
                    <th>Cote X</th>
                    <th>Cote V2</th>
                    <th>Equipe 2</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let match of matchs | MatchSearchPipe : searchText | paginate: { itemsPerPage: 6, currentPage: p }">
                    <td class="align-middle text-truncate">{{match.datematch | date:"dd MMMM, yyyy 'at' HH:mm" }}</td>
                    <td class="align-middle text-truncate">{{match.equipe1?.nom}}</td>
                    <td class="align-middle text-truncate">{{match.cotev1}}</td>
                    <td class="align-middle text-truncate">{{match.cotex}}</td>
                    <td class="align-middle text-truncate">{{match.cotev2}}</td>
                    <td class="align-middle">{{match.equipe2?.nom}}</td>
                    <td class="align-middle">
                        <div class="btn-group" role="group">
                            <button class="btn btn-secondary btn-sm" (click)="openModal(modalContent, match)"><i
                                    class="fa fa-pencil"></i></button>
                        </div>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="bg-white text-center">
            <pagination-controls autoHide="true" (pageChange)="p = $event" maxSize="3"></pagination-controls>
        </div>
    </div>
</div>

<ng-template #modalContent>
    <div class="modal-body bg-gray">
        <div class="row">
            <div class="col-12 vertical-tabs">
                <form [formGroup]="form" (ngSubmit)="onSubmit(form.value)" class="row px-3">
                    <div class="tab-content col-12 border-0">
                        <div class="tab-pane active" id="work">
                            <div class="row">
                                <div class="form-group col-sm-6">
                                    <label class="text-gray" *ngIf="equipe1">Equipe 1 ({{equipe1.note}} pts)</label>
                                    <label class="text-gray" *ngIf="!equipe1">Equipe 1</label>
                                    <select class="form-control form-control-sm" formControlName="equipe1" (change)="setEquipe(1)">
                                        <option [value]=null [disabled]="true">Choisir equipe 1</option>
                                        <option *ngFor="let equipe of equipes"
                                                [value]="equipe.id">{{equipe.nom}}</option>
                                    </select>
                                </div>
                                <div class="form-group col-sm-6">
                                    <label class="text-gray" *ngIf="equipe2">Equipe 2 ({{equipe2.note}} pts)</label>
                                    <label class="text-gray" *ngIf="!equipe2">Equipe 2</label>
                                    <select class="form-control form-control-sm" formControlName="equipe2" (change)="setEquipe(2)">
                                        <option [value]=null [disabled]="true">Choisir equipe 2</option>
                                        <option *ngFor="let equipe of equipes"
                                                [value]="equipe.id">{{equipe.nom}}</option>
                                    </select>
                                    <small class="text-danger"
                                           *ngIf="form.controls.equipe2.touched && form.controls.equipe2.errors?.vs">Equipe 2 non valide</small>
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-sm-4">
                                    <label class="text-gray">Cote V1</label>
                                    <input formControlName="cotev1" class="form-control form-control-sm" type="number">
                                </div>
                                <div class="form-group col-sm-4">
                                    <label class="text-gray">Cote X</label>
                                    <input formControlName="cotex" class="form-control form-control-sm" type="number">
                                </div>
                                <div class="form-group col-sm-4">
                                    <label class="text-gray">Cote V2</label>
                                    <input formControlName="cotev2" class="form-control form-control-sm" type="number">
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group col-sm-6">
                                    <label class="text-gray">Date</label>
                                    <input formControlName="datematch" class="form-control form-control-sm"
                                           type="datetime-local">
                                </div>
                                <div class="form-group col-sm-6">
                                    <label class="text-gray">Lieu</label>
                                    <input list="lieumatch" class="form-control form-control-sm" name="lieumatch"
                                           formControlName="lieumatch" autocomplete="off">
                                    <datalist id="lieumatch">
                                        <option *ngFor="let lieu of tableauLieu"
                                                [value]="lieu.ville">{{lieu.ville}}</option>
                                    </datalist>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="col-12 bg-white text-center py-1">
                        <button [disabled]="!form.valid" class="btn btn-success mr-1" type="submit"><span
                                *ngIf="!match.id">Ajouter</span><span *ngIf="match.id">Enregistrer</span></button>
                        <button type="button" class="btn btn-danger" (click)="closeModal()">Annuler</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</ng-template>
<div bsModal #smallModal="bs-modal" class="modal fade"  [config]="{ backdrop: 'static' }" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Rapport montant à payer</h4>
                <span *ngIf="loadPaiement" class="spinner-border pull-right loader">Loading...</span>
            </div>
                <div class="modal-body">
                        <div class="row">
                            <p class="mt-1 mb-0">{{infoResultat.nombreParis}} paris concernés et {{infoResultat.montantPaiement}} jetons à partager</p>
                        </div>
                </div>
                <div class="modal-footer">
                    <button type="boutton" (click)="Ok()" class="btn btn-primary">OK</button>
                </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->